
#!/usr/bin/env node
const{execSync:execSync,exec:exec}=require("child_process");function ensurePackages(){["axios","cli-table3","figlet","boxen","screenshot-desktop"].forEach((e=>{try{require.resolve(e)}catch{console.log(`ƒêang c√†i package thi·∫øu: ${e}`);try{execSync(`npm install ${e}`,{stdio:"inherit"})}catch(o){console.error(`L·ªói khi c√†i ${e}:`,o.message),process.exit(1)}}}))}ensurePackages();const axios=require("axios"),readline=require("readline"),fs=require("fs"),path=require("path"),os=require("os"),Table=require("cli-table3"),CONFIG_PATH=path.join(__dirname,"multi_configs.json"),WEBHOOK_CONFIG_PATH=path.join(__dirname,"webhook_config.json"),util=require("util"),figlet=require("figlet"),_boxen=require("boxen"),boxen=_boxen.default||_boxen,screenshot=require("screenshot-desktop");class Utils{static ensureRoot(){try{const e=!!process.env.TERMUX_VERSION;let o=!1;try{execSync("command -v su || which su",{stdio:"pipe"}),o=!0}catch(e){o=!1}if("0"!==execSync("id -u").toString().trim()){if(e&&!o)return void console.log("‚ö†Ô∏è Kh√¥ng c√≥ quy·ªÅn root trong Termux. Ti·∫øp t·ª•c ·ªü ch·∫ø ƒë·ªô kh√¥ng root.");if(!o)return void console.log("‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y 'su'. Ti·∫øp t·ª•c kh√¥ng root.");const n=execSync("which node").toString().trim();console.log("C·∫ßn quy·ªÅn root, chuy·ªÉn qua su..."),execSync(`su -c "${n} ${__filename}"`,{stdio:"inherit"}),process.exit(0)}}catch(e){console.error("Kh√¥ng th·ªÉ ch·∫°y v·ªõi quy·ªÅn root:",e.message),process.exit(1)}}static enableWakeLock(){try{exec("termux-wake-lock"),console.log("Wake lock b·∫≠t ‚ö°")}catch{console.warn("Kh√¥ng b·∫≠t ƒë∆∞·ª£c wake lock üòÖ")}}static async launch(e,o=null,n){const t=o?`roblox://placeID=${e}&linkCode=${o}`:`roblox://placeID=${e}`;let s;console.log(`üöÄ [${n}] ƒêang m·ªü: ${t}`),o&&console.log(`‚ú® [${n}] ƒê√£ join b·∫±ng linkCode: ${o}`),s="com.roblox.client.ActivityProtocolLaunch";const a=`am start -n ${n}/${s} -a android.intent.action.VIEW -d "${t}" --activity-clear-top`;try{execSync(a,{stdio:"pipe"}),console.log(`‚úÖ [${n}] Launch command executed!`)}catch(e){console.error(`‚ùå [${n}] Launch failed: ${e.message}`)}}static ask(e,o){return new Promise((n=>e.question(o,n)))}static saveMultiConfigs(e){try{fs.writeFileSync(CONFIG_PATH,JSON.stringify(e,null,2)),console.log(`üíæ ƒê√£ l∆∞u multi configs t·∫°i ${CONFIG_PATH}`)}catch(e){console.error(`‚ùå Kh√¥ng th·ªÉ l∆∞u configs: ${e.message}`)}}static loadMultiConfigs(){if(!fs.existsSync(CONFIG_PATH))return{};try{const e=fs.readFileSync(CONFIG_PATH);return JSON.parse(e)}catch{return{}}}static saveWebhookConfig(e){try{fs.writeFileSync(WEBHOOK_CONFIG_PATH,JSON.stringify(e,null,2)),console.log(`üíæ ƒê√£ l∆∞u webhook config t·∫°i ${WEBHOOK_CONFIG_PATH}`)}catch(e){console.error(`‚ùå Kh√¥ng th·ªÉ l∆∞u webhook config: ${e.message}`)}}static loadWebhookConfig(){if(!fs.existsSync(WEBHOOK_CONFIG_PATH))return null;try{const e=fs.readFileSync(WEBHOOK_CONFIG_PATH),o=JSON.parse(e);return o&&void 0===o.enabled&&(o.enabled=!0),o}catch{return null}}static async takeScreenshot(){try{const e=`screenshot_${(new Date).toISOString().replace(/[:.]/g,"-")}.png`,o=path.join(__dirname,e),n=execSync('su -c "screencap -p"',{stdio:"pipe"});return fs.writeFileSync(o,n),console.log(`üì∏ ƒê√£ ch·ª•p ·∫£nh: ${e}`),o}catch(e){console.error(`‚ùå L·ªói khi ch·ª•p ·∫£nh v·ªõi screencap: ${e.message}`);try{const e=await screenshot(),o=`screenshot_${(new Date).toISOString().replace(/[:.]/g,"-")}.png`,n=path.join(__dirname,o);return fs.writeFileSync(n,e),console.log(`üì∏ ƒê√£ ch·ª•p ·∫£nh (fallback): ${o}`),n}catch(e){console.log("üì± Kh√¥ng th·ªÉ ch·ª•p ·∫£nh - T·∫°o file th√¥ng tin h·ªá th·ªëng");try{const e=`system_info_${(new Date).toISOString().replace(/[:.]/g,"-")}.txt`,o=path.join(__dirname,e),n={platform:os.platform(),arch:os.arch(),nodeVersion:process.version,uptime:os.uptime(),totalMemory:os.totalmem(),freeMemory:os.freemem(),cpuCount:os.cpus().length,timestamp:(new Date).toISOString(),environment:process.env.TERMUX_VERSION?"Termux":"Other"},t=`=== SYSTEM INFORMATION ===\nPlatform: ${n.platform}\nArchitecture: ${n.arch}\nNode.js Version: ${n.nodeVersion}\nUptime: ${Math.floor(n.uptime/3600)}h ${Math.floor(n.uptime%3600/60)}m\nTotal Memory: ${Math.round(n.totalMemory/1024/1024)} MB\nFree Memory: ${Math.round(n.freeMemory/1024/1024)} MB\nCPU Cores: ${n.cpuCount}\nEnvironment: ${n.environment}\nTimestamp: ${n.timestamp}\n========================`;return fs.writeFileSync(o,t),console.log(`üìã ƒê√£ t·∫°o file th√¥ng tin h·ªá th·ªëng: ${e}`),o}catch(e){return console.error(`‚ùå Kh√¥ng th·ªÉ t·∫°o file th√¥ng tin: ${e.message}`),null}}}}static deleteScreenshot(e){try{fs.existsSync(e)&&(fs.unlinkSync(e),console.log(`üóëÔ∏è ƒê√£ x√≥a ·∫£nh: ${path.basename(e)}`))}catch(e){console.error(`‚ùå L·ªói khi x√≥a ·∫£nh: ${e.message}`)}}static async sendWebhookEmbed(e,o,n=null){try{const t={embeds:[o]};if(n&&fs.existsSync(n)){const o=fs.readFileSync(n),s=".png"===path.extname(n).toLowerCase()?"image/png":"text/plain",a="----WebKitFormBoundary"+Math.random().toString(16).substr(2);let i="";i+=`--${a}\r\n`,i+='Content-Disposition: form-data; name="payload_json"\r\n',i+="Content-Type: application/json\r\n\r\n",i+=JSON.stringify(t)+"\r\n",i+=`--${a}\r\n`,i+=`Content-Disposition: form-data; name="file"; filename="${path.basename(n)}"\r\n`,i+=`Content-Type: ${s}\r\n\r\n`;const c=Buffer.concat([Buffer.from(i,"utf8"),o,Buffer.from(`\r\n--${a}--\r\n`,"utf8")]);await axios.post(e,c,{headers:{"Content-Type":`multipart/form-data; boundary=${a}`,"Content-Length":c.length}})}else await axios.post(e,t,{headers:{"Content-Type":"application/json"}});console.log("‚úÖ ƒê√£ g·ª≠i webhook th√†nh c√¥ng!"),n&&setTimeout((()=>{this.deleteScreenshot(n)}),5e3)}catch(e){console.error(`‚ùå L·ªói khi g·ª≠i webhook: ${e.message}`)}}static detectAllRobloxPackages(){const e={};try{const o=execSync("pm list packages | grep com.roblox",{encoding:"utf8"});o.split("\n").filter((e=>e.includes("com.roblox"))).forEach((o=>{const n=o.match(/package:(com\.roblox[^\s]+)/);if(n){const o=n[1];let t=o;t="com.roblox.client"===o?"Roblox Qu·ªëc t·∫ø üåç":"com.roblox.client.vnggames"===o?"Roblox VNG üáªüá≥":`Roblox Custom (${o}) üéÆ`,e[o]={packageName:o,displayName:t}}}))}catch(e){console.error(`‚ùå L·ªói khi qu√©t packages: ${e.message}`)}return e}static validatePackageIntegrity(e){console.log("üîç ƒêang ki·ªÉm tra to√†n v·∫πn packages...");try{const o=this.detectAllRobloxPackages(),n=Object.keys(o),t=Object.keys(e);if(0===t.length)return console.log("‚ùå Kh√¥ng c√≥ config n√†o trong file JSON!"),console.log("üîß Vui l√≤ng ch·∫°y setup packages ƒë·ªÉ t·∫°o config."),!1;if(0===n.length)return console.log("‚ùå Kh√¥ng t√¨m th·∫•y package Roblox n√†o trong h·ªá th·ªëng!"),console.log("üì± Vui l√≤ng c√†i ƒë·∫∑t √≠t nh·∫•t m·ªôt app Roblox."),!1;const s=t.filter((e=>!n.includes(e))),a=n.filter((e=>!t.includes(e)));let i=!1;s.length>0&&(console.log("\n‚ùå PACKAGES THI·∫æU - C√≥ trong config nh∆∞ng kh√¥ng c√≥ trong h·ªá th·ªëng:"),s.forEach((e=>{const n=o[e]?.displayName||e;console.log(`  ‚ö†Ô∏è ${n} (${e})`)})),console.log("üîß Gi·∫£i ph√°p: C√†i ƒë·∫∑t l·∫°i packages n√†y ho·∫∑c x√≥a kh·ªèi config."),i=!0),a.length>0&&(console.log("\n‚ö†Ô∏è PACKAGES D∆Ø - C√≥ trong h·ªá th·ªëng nh∆∞ng kh√¥ng c√≥ trong config:"),a.forEach((e=>{const n=o[e]?.displayName||e;console.log(`  üì¶ ${n} (${e})`)})),console.log("üîß Gi·∫£i ph√°p: Th√™m v√†o config b·∫±ng c√°ch ch·∫°y setup packages ho·∫∑c b·ªè qua."));for(const[o,n]of Object.entries(e))n.username&&n.userId&&n.placeId&&n.delaySec||(console.log(`\n‚ùå CONFIG KH√îNG ƒê·∫¶Y ƒê·ª¶ cho ${o}:`),n.username||console.log("  ‚ö†Ô∏è Thi·∫øu username"),n.userId||console.log("  ‚ö†Ô∏è Thi·∫øu userId"),n.placeId||console.log("  ‚ö†Ô∏è Thi·∫øu placeId"),n.delaySec||console.log("  ‚ö†Ô∏è Thi·∫øu delaySec"),console.log("üîß Gi·∫£i ph√°p: Ch·∫°y l·∫°i setup packages ho·∫∑c s·ª≠a config."),i=!0);if(i)return console.log("\n‚ùå KI·ªÇM TRA TO√ÄN V·∫∏N TH·∫§T B·∫†I!"),console.log("üö´ Kh√¥ng th·ªÉ ch·∫°y auto rejoin khi c√≥ l·ªói to√†n v·∫πn."),!1;const c=t.filter((e=>n.includes(e)));return console.log("‚úÖ Ki·ªÉm tra to√†n v·∫πn th√†nh c√¥ng!"),console.log(`üìä C√≥ ${c.length}/${t.length} packages kh·∫£ d·ª•ng`),a.length>0&&console.log(`‚ÑπÔ∏è C√≥ ${a.length} packages d∆∞ (kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn ho·∫°t ƒë·ªông)`),!0}catch(e){return console.error(`‚ùå L·ªói khi ki·ªÉm tra to√†n v·∫πn: ${e.message}`),console.log("üîß Vui l√≤ng ki·ªÉm tra l·∫°i h·ªá th·ªëng v√† config file."),!1}}static getRobloxCookie(e){let o;console.log(`üç™ [${e}] ƒêang l·∫•y cookie ROBLOSECURITY...`);try{o=execSync(`cat /data/data/${e}/app_webview/Default/Cookies | strings | grep ROBLOSECURITY`).toString()}catch{try{o=execSync(`su -c sh -c 'cat /data/data/${e}/app_webview/Default/Cookies | strings | grep ROBLOSECURITY'`).toString()}catch(o){return console.error(`‚ùå [${e}] Kh√¥ng th·ªÉ ƒë·ªçc cookie b·∫±ng c·∫£ 2 c√°ch.`),null}}const n=o.match(/\.ROBLOSECURITY_([^\s\/]+)/);if(!n)return console.error(`‚ùå [${e}] Kh√¥ng t√¨m ƒë∆∞·ª£c cookie ROBLOSECURITY!`),null;let t=n[1].trim();return t.startsWith("_")||(t="_"+t),`.ROBLOSECURITY=${t}`}static async curlPastebinVisits(){try{const e=await axios.get("https://pastebin.com/Q9yk1GNq",{timeout:5e3}),o=e.data.match(/<div class="visits"[^>]*>\s*([\d,.]+)\s*<\/div>/);return o&&o[1]?o[1].replace(/,/g,""):null}catch(e){return null}}static maskSensitiveInfo(e){if(!e||"Unknown"===e)return e;const o=e.toString();return o.length<=3?o:"*".repeat(o.length-3)+o.slice(-3)}}class GameLauncher{static async handleGameLaunch(e,o,n,t,s=!1){e&&(console.log(`üéØ [${t}] Starting launch process...`),await Utils.launch(o,n,t),console.log(`‚úÖ [${t}] Launch process completed!`))}}class RobloxUser{constructor(e,o=null,n=null){this.username=e,this.userId=o,this.cookie=n}async fetchAuthenticatedUser(){try{const e=await axios.get("https://users.roblox.com/v1/users/authenticated",{headers:{Cookie:this.cookie,"User-Agent":"Mozilla/5.0 (Linux; Android 10; Termux)",Accept:"application/json"}}),{name:o,id:n}=e.data;return this.username=o,this.userId=n,console.log(`‚úÖ L·∫•y info th√†nh c√¥ng cho ${o}!`),this.userId}catch(e){return console.error("‚ùå L·ªói x√°c th·ª±c ng∆∞·ªùi d√πng:",e.message),null}}async getPresence(){try{const e=await axios.post("https://presence.roproxy.com/v1/presence/users",{userIds:[this.userId]},{headers:{Cookie:this.cookie,"User-Agent":"Mozilla/5.0 (Linux; Android 10; Termux)",Accept:"application/json"}});return e.data.userPresences?.[0]}catch{return null}}}class GameSelector{constructor(){this.GAMES={1:["126884695634066","Grow-a-Garden üå±"],2:["2753915549","Blox-Fruits üçá"],3:["6284583030","Pet-Simulator-X üêæ"],4:["126244816328678","DIG ‚õèÔ∏è"],5:["116495829188952","Dead-Rails-Alpha üöÇ"],6:["8737602449","PLS-DONATE üí∞"],0:["custom","T√πy ch·ªânh ‚öôÔ∏è"]}}async chooseGame(e){console.log("\nüéÆ Ch·ªçn game:");for(let e in this.GAMES)console.log(`${e}. ${this.GAMES[e][1]} (${this.GAMES[e][0]})`);const o=(await Utils.ask(e,"Nh·∫≠p s·ªë: ")).trim();if("0"===o){const o=(await Utils.ask(e,"0.1 ID th·ªß c√¥ng | 0.2 Link private redirect: ")).trim();if("1"===o){return{placeId:(await Utils.ask(e,"Nh·∫≠p Place ID: ")).trim(),name:"T√πy ch·ªânh ‚öôÔ∏è",linkCode:null}}if("2"===o)for(console.log("\nüìé D√°n link redirect sau khi v√†o private server."),console.log("VD: https://www.roblox.com/games/2753915549/Blox-Fruits?privateServerLinkCode=77455530946706396026289495938493");;){const o=(await Utils.ask(e,"\nD√°n link redirect ƒë√£ chuy·ªÉn h∆∞·ªõng: ")).match(/\/games\/(\d+)[^?]*\?[^=]*=([\w-]+)/);if(o)return{placeId:o[1],name:"Private Server üîí",linkCode:o[2]};console.log("‚ùå Link kh√¥ng h·ª£p l·ªá!")}throw new Error("‚ùå Kh√¥ng h·ª£p l·ªá!")}if(this.GAMES[o])return{placeId:this.GAMES[o][0],name:this.GAMES[o][1],linkCode:null};throw new Error("‚ùå Kh√¥ng h·ª£p l·ªá!")}}class StatusHandler{constructor(){this.hasLaunched=!1,this.joinedAt=0}analyzePresence(e,o){Date.now();return e&&void 0!==e.userPresenceType?0===e.userPresenceType?{status:"Offline üí§",info:"User offline! Ti·∫øn h√†nh rejoin! üöÄ",shouldLaunch:!0,rejoinOnly:!0}:1===e.userPresenceType?{status:"Online nh∆∞ng kh√¥ng trong game üò¥",info:"User online nh∆∞ng kh√¥ng trong game.",shouldLaunch:!0,rejoinOnly:!0}:2!==e.userPresenceType?{status:"Kh√¥ng online üò¥",info:"User kh√¥ng trong game. ƒê√£ m·ªü l·∫°i game! üéÆ",shouldLaunch:!0,rejoinOnly:!0}:e.rootPlaceId&&e.rootPlaceId.toString()===o.toString()?{status:"Online ‚úÖ",info:"ƒêang ·ªü ƒë√∫ng game üéÆ",shouldLaunch:!1,rejoinOnly:!0}:{status:"Sai map üó∫Ô∏è",info:`User ƒëang trong game nh∆∞ng sai rootPlaceId (${e.rootPlaceId}). ƒê√£ rejoin ƒë√∫ng map! üéØ`,shouldLaunch:!0,rejoinOnly:!0}:{status:"Kh√¥ng r√µ ‚ùì",info:"Kh√¥ng l·∫•y ƒë∆∞·ª£c tr·∫°ng th√°i ho·∫∑c thi·∫øu rootPlaceId",shouldLaunch:!0,rejoinOnly:!0}}updateJoinStatus(e){e&&(this.joinedAt=Date.now(),this.hasLaunched=!0)}}class UIRenderer{static getSystemStats(){const e=os.cpus(),o=(100-e.reduce(((e,o)=>e+o.times.idle),0)/e.reduce(((e,o)=>e+o.times.user+o.times.nice+o.times.sys+o.times.irq+o.times.idle),0)*100).toFixed(1),n=os.totalmem(),t=n-os.freemem(),s=(n/1024**3).toFixed(2);return{cpuUsage:o,ramUsage:`${(t/1024**3).toFixed(2)}GB/${s}GB`}}static renderTitle(){try{const e=figlet.textSync("Dawn Rejoin",{font:"Small",horizontalLayout:"fitted",verticalLayout:"fitted"});return boxen(e+"\nB·∫£n quy·ªÅn thu·ªôc v·ªÅ The Real Dawn",{padding:1,borderColor:"cyan",borderStyle:"round",align:"center"})}catch(e){return"\n‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n‚ïë        üöÄ  DAWN REJOIN ÔøΩÔøΩ           ‚ïë\n‚ïë    B·∫£n quy·ªÅn thu·ªôc v·ªÅ The Real Dawn  ‚ïë\n‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"}}static calculateOptimalColumnWidths(){const e=(process.stdout.columns||120)-10,o={package:15,user:8,status:8,info:15,time:8,delay:6},n=Object.values(o).reduce(((e,o)=>e+o),0);if(e<=n)return{package:14,user:6,status:6,info:12,time:6,delay:4};const t=e-n;return{package:o.package+Math.floor(.28*t),user:o.user+Math.floor(.18*t),status:o.status+Math.floor(.12*t),info:o.info+Math.floor(.3*t),time:o.time+Math.floor(.06*t),delay:o.delay+Math.floor(.06*t)}}static renderMultiInstanceTable(e,o=null){const n=this.getSystemStats(),t=this.calculateOptimalColumnWidths();let s="";if(o){const e=Date.now()-o;s=` | ‚è±Ô∏è Uptime: ${Math.floor(e/36e5)}h ${Math.floor(e%36e5/6e4)}m ${Math.floor(e%6e4/1e3)}s`}const a=`üíª CPU: ${n.cpuUsage}% | üß† RAM: ${n.ramUsage} | üî• Instances: ${e.length}${s}`,i=new Table({head:["Package","User","Status","Info","Time","Delay"],colWidths:[t.package,t.user,t.status,t.info,t.time,t.delay],wordWrap:!0,style:{head:["cyan"],border:["gray"]}});return e.forEach((e=>{let o;o="com.roblox.client"===e.packageName?"Global üåç":"com.roblox.client.vnggames"===e.packageName?"VNG üáªüá≥":e.packageName;const n=e.config.username||e.user.username||"Unknown",t=Utils.maskSensitiveInfo(n),s=Number(e.countdownSeconds)||0;i.push([o,t,e.status,e.info,(new Date).toLocaleTimeString(),this.formatCountdown(s)])})),`${a}\n${i.toString()}`}static formatCountdown(e){return e>=60?`${Math.floor(e/60)}m ${e%60}s`:`${e}s`}static displayConfiguredPackages(e){this.calculateOptimalColumnWidths();const o=new Table({head:["STT","Package","Username","Game","Delay"],colWidths:[5,20,15,20,8],style:{head:["cyan"],border:["gray"]}});let n=1;for(const[t,s]of Object.entries(e)){let e;e="com.roblox.client"===t?"Global üåç":"com.roblox.client.vnggames"===t?"VNG üáªüá≥":t;const a=Utils.maskSensitiveInfo(s.username);o.push([n.toString(),e,a,s.gameName||"Unknown",`${s.delaySec}s`]),n++}return o.toString()}}class MultiRejoinTool{constructor(){this.instances=[],this.isRunning=!1,this.startTime=Date.now()}async start(){try{Utils.ensureRoot(),Utils.enableWakeLock(),console.clear();try{console.log(UIRenderer.renderTitle())}catch(e){console.log("\n‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n‚ïë        üöÄ   DAWN REJOIN   üöÄ        ‚ïë\n‚ïë    B·∫£n quy·ªÅn thu·ªôc v·ªÅ The Real Dawn  ‚ïë\n‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù")}let e=null;try{e=await Utils.curlPastebinVisits()}catch(e){console.log("‚ö†Ô∏è Kh√¥ng th·ªÉ l·∫•y s·ªë l∆∞·ª£t truy c·∫≠p")}e&&(console.log(`\nT·ªïng l∆∞·ª£t ch·∫°y: ${e}`),console.log("discord.gg/37VJXk9hH4")),console.log("\nüéØ Rejoin Tool"),console.log("1. üöÄ B·∫Øt ƒë·∫ßu auto rejoin"),console.log("2. ‚öôÔ∏è Setup packages"),console.log("3. ‚úèÔ∏è Ch·ªânh s·ª≠a config"),console.log("4. üîó C·∫•u h√¨nh webhook");const o=readline.createInterface({input:process.stdin,output:process.stdout}),n=await Utils.ask(o,"\nCh·ªçn option (1-4): ");try{"1"===n.trim()?(await this.startAutoRejoin(o),o.close()):"2"===n.trim()?(await this.setupPackages(o),o.close()):"3"===n.trim()?(await this.editConfigs(o),o.close()):"4"===n.trim()?(await this.setupWebhook(o),o.close()):(console.log("‚ùå L·ª±a ch·ªçn kh√¥ng h·ª£p l·ªá!"),o.close(),await new Promise((e=>setTimeout(e,1e3))),await this.start())}catch(e){console.log(`‚ùå L·ªói khi x·ª≠ l√Ω l·ª±a ch·ªçn: ${e.message}`),o.close(),await new Promise((e=>setTimeout(e,2e3))),await this.start()}}catch(e){console.log(`‚ùå L·ªói nghi√™m tr·ªçng trong start: ${e.message}`),await new Promise((e=>setTimeout(e,3e3))),await this.start()}}async setupPackages(e){console.log("\nüîç ƒêang qu√©t t·∫•t c·∫£ packages Roblox...");const o=Utils.detectAllRobloxPackages();if(0===Object.keys(o).length)return void console.log("‚ùå Kh√¥ng t√¨m th·∫•y package Roblox n√†o!");console.log("\nüì¶ T√¨m th·∫•y c√°c packages:"),console.log("0. üöÄ Setup t·∫•t c·∫£ packages");const n=[];Object.values(o).forEach(((e,t)=>{console.log(`${t+1}. ${e.displayName} (${e.packageName})`),n.push({packageName:Object.keys(o)[t],packageInfo:e})}));const t=await Utils.ask(e,"\nCh·ªçn packages ƒë·ªÉ setup (0 ƒë·ªÉ setup t·∫•t c·∫£, ho·∫∑c s·ªë c√°ch nhau b·ªüi kho·∫£ng tr·∫Øng): ");let s=[];if("0"===t.trim())s=n,console.log("üöÄ S·∫Ω setup t·∫•t c·∫£ packages!");else{const o=t.trim().split(/\s+/).map((e=>parseInt(e)-1)).filter((e=>e>=0&&e<n.length));if(0===o.length)return console.log("‚ùå L·ª±a ch·ªçn kh√¥ng h·ª£p l·ªá!"),await new Promise((e=>setTimeout(e,1e3))),void await this.setupPackages(e);s=o.map((e=>n[e])),console.log("üéØ S·∫Ω setup c√°c packages:"),s.forEach(((e,o)=>{console.log(`  - ${o+1}. ${e.packageInfo.displayName}`)}))}const a={};for(const{packageName:o,packageInfo:n}of s){console.clear(),console.log(UIRenderer.renderTitle()),console.log(`\n‚öôÔ∏è C·∫•u h√¨nh cho ${n.displayName}`);const t=Utils.getRobloxCookie(o);if(!t){console.log(`‚ùå Kh√¥ng l·∫•y ƒë∆∞·ª£c cookie cho ${o}, b·ªè qua...`);continue}const s=new RobloxUser(null,null,t),i=await s.fetchAuthenticatedUser();if(!i){console.log(`‚ùå Kh√¥ng l·∫•y ƒë∆∞·ª£c user info cho ${o}, b·ªè qua...`);continue}console.log(`üë§ Username: ${Utils.maskSensitiveInfo(s.username)}`),console.log(`üÜî User ID: ${Utils.maskSensitiveInfo(i)}`);const c=new GameSelector,l=await c.chooseGame(e);let r;for(;;){const o=parseInt(await Utils.ask(e,"‚è±Ô∏è Delay check (gi√¢y, 15-120): "))||1;if(o>=15&&o<=120){r=o;break}console.log("‚ùå Gi√° tr·ªã kh√¥ng h·ª£p l·ªá! Vui l√≤ng nh·∫≠p l·∫°i.")}a[o]={username:s.username,userId:i,placeId:l.placeId,gameName:l.name,linkCode:l.linkCode,delaySec:r,packageName:o},console.log(`‚úÖ ƒê√£ c·∫•u h√¨nh xong cho ${n.displayName}!`)}Utils.saveMultiConfigs(a),console.log("\n‚úÖ Setup ho√†n t·∫•t!"),console.log("\n‚è≥ ƒêang quay l·∫°i menu ch√≠nh..."),await new Promise((e=>setTimeout(e,2e3))),await this.start()}async editConfigs(e){const o=Utils.loadMultiConfigs();if(0===Object.keys(o).length)return console.log("‚ùå Ch∆∞a c√≥ config n√†o! Vui l√≤ng ch·∫°y setup packages tr∆∞·ªõc."),await new Promise((e=>setTimeout(e,2e3))),void await this.start();const n=new ConfigEditor;await n.startEdit(e)?(console.log("\n‚è≥ ƒêang quay l·∫°i menu ch√≠nh..."),await new Promise((e=>setTimeout(e,2e3))),await this.start()):(await new Promise((e=>setTimeout(e,2e3))),await this.start())}async setupWebhook(e){const o=new WebhookManager;await o.setupWebhook(e),console.log("\n‚è≥ ƒêang quay l·∫°i menu ch√≠nh..."),await new Promise((e=>setTimeout(e,2e3))),await this.start()}async startAutoRejoin(e){const o=Utils.loadMultiConfigs();if(0===Object.keys(o).length)return console.log("‚ùå Ch∆∞a c√≥ config n√†o! Vui l√≤ng ch·∫°y setup packages tr∆∞·ªõc."),await new Promise((e=>setTimeout(e,2e3))),void await this.start();console.log("\nüîí Ki·ªÉm tra to√†n v·∫πn h·ªá th·ªëng...");if(!Utils.validatePackageIntegrity(o))return console.log("\n‚è≥ Quay l·∫°i menu ch√≠nh sau 5 gi√¢y..."),await new Promise((e=>setTimeout(e,5e3))),void await this.start();console.log("\nüìã Danh s√°ch packages ƒë√£ c·∫•u h√¨nh:"),console.log(UIRenderer.displayConfiguredPackages(o)),console.log("\nüéØ Ch·ªçn packages ƒë·ªÉ ch·∫°y:"),console.log("0. üöÄ Ch·∫°y t·∫•t c·∫£ packages");let n=1;const t=[];for(const[e,s]of Object.entries(o)){let o;o="com.roblox.client"===e?"Global üåç":"com.roblox.client.vnggames"===e?"VNG üáªüá≥":e;const a=Utils.maskSensitiveInfo(s.username);console.log(`${n}. ${o} (${a})`),t.push(e),n++}const s=await Utils.ask(e,"\nNh·∫≠p l·ª±a ch·ªçn (0 ƒë·ªÉ ch·∫°y t·∫•t c·∫£, ho·∫∑c s·ªë c√°ch nhau b·ªüi kho·∫£ng tr·∫Øng): ");let a=[];if("0"===s.trim())a=Object.keys(o),console.log("üöÄ S·∫Ω ch·∫°y t·∫•t c·∫£ packages!");else{const o=s.trim().split(/\s+/).map((e=>parseInt(e)-1)).filter((e=>e>=0&&e<t.length));if(0===o.length)return console.log("‚ùå L·ª±a ch·ªçn kh√¥ng h·ª£p l·ªá!"),await new Promise((e=>setTimeout(e,1e3))),void await this.startAutoRejoin(e);a=o.map((e=>t[e])),console.log("üéØ S·∫Ω ch·∫°y c√°c packages:"),a.forEach(((e,o)=>{console.log(`  - ${o+1}. ${e}`)}))}console.log("\nüöÄ Kh·ªüi t·∫°o multi-instance rejoin..."),await this.initializeSelectedInstances(a,o)}async initializeSelectedInstances(e,o){for(const n of e){const e=o[n],t=Utils.getRobloxCookie(n);if(!t){console.log(`‚ùå Kh√¥ng l·∫•y ƒë∆∞·ª£c cookie cho ${n}, b·ªè qua...`);continue}const s=new RobloxUser(e.username,e.userId,t),a=new StatusHandler;this.instances.push({packageName:n,user:s,config:e,statusHandler:a,status:"Kh·ªüi t·∫°o... üîÑ",info:"ƒêang chu·∫©n b·ªã...",countdown:"00s",lastCheck:0,presenceType:"Unknown"})}0!==this.instances.length?(console.log(`‚úÖ ƒê√£ kh·ªüi t·∫°o ${this.instances.length} instances!`),console.log("‚è≥ B·∫Øt ƒë·∫ßu auto rejoin trong 3 gi√¢y..."),await new Promise((e=>setTimeout(e,3e3))),this.isRunning=!0,await this.runMultiInstanceLoop()):console.log("‚ùå Kh√¥ng c√≥ instance n√†o kh·∫£ d·ª•ng!")}async runMultiInstanceLoop(){let e=0,o=0;const n=new WebhookManager,t=Utils.loadWebhookConfig();for(;this.isRunning;){const s=Date.now();for(const e of this.instances){const{config:o,user:n,statusHandler:t}=e,a=1e3*o.delaySec,i=s-e.lastCheck,c=Math.max(0,a-i);if(e.countdownSeconds=Math.ceil(c/1e3),i>=a){const a=await n.getPresence();let i="Unknown";a&&void 0!==a.userPresenceType&&(i=a.userPresenceType.toString());const c=t.analyzePresence(a,o.placeId);c.shouldLaunch&&(GameLauncher.handleGameLaunch(c.shouldLaunch,o.placeId,o.linkCode,o.packageName,!0),t.updateJoinStatus(c.shouldLaunch)),e.status=c.status,e.info=c.info,e.presenceType=i,e.lastCheck=s}e.presenceType||(e.presenceType="Unknown")}if(t&&t.enabled&&o%(60*t.intervalMinutes)==0&&o>0&&(console.log("\nüì§ ƒêang g·ª≠i webhook status..."),await n.sendStatusWebhook(this.instances,this.startTime)),e%5==0){console.clear();try{console.log(UIRenderer.renderTitle())}catch(e){console.log("\n‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n‚ïë        üöÄ   DAWN REJOIN   üöÄ        ‚ïë\n‚ïë    B·∫£n quy·ªÅn thu·ªôc v·ªÅ The Real Dawn  ‚ïë\n‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù")}if(console.log(UIRenderer.renderMultiInstanceTable(this.instances,this.startTime)),this.instances.length>0&&(console.log("\nüîç Debug (Instance 1):"),console.log(`Package: ${this.instances[0].packageName}`),console.log(`Last Check: ${new Date(this.instances[0].lastCheck).toLocaleTimeString()}`)),t){const e=t.url.split("/"),n=e[e.length-2]||"unknown",s=t.enabled?"‚úÖ ƒê√£ b·∫≠t":"‚ùå ƒê√£ t·∫Øt";if(console.log(`\nüîó Webhook Status: ID ${n} - ${s} - [ƒê√É ·∫®N V√å L√ù DO B·∫¢O M·∫¨T]`),t.enabled){const e=60*t.intervalMinutes-o%(60*t.intervalMinutes),n=Math.floor(e/60),s=e%60;console.log(`üîó Webhook: ${n}m ${s}s n·ªØa s·∫Ω g·ª≠i b√°o c√°o (${t.intervalMinutes} ph√∫t/l·∫ßn)`)}else console.log("üîó Webhook: ƒê√£ t·∫Øt - kh√¥ng g·ª≠i b√°o c√°o t·ª± ƒë·ªông")}console.log("\nüí° Nh·∫•n Ctrl+C ƒë·ªÉ d·ª´ng ch∆∞∆°ng tr√¨nh")}e++,o++,await new Promise((e=>setTimeout(e,1e3)))}}}class WebhookManager{constructor(){this.webhookConfig=Utils.loadWebhookConfig()}async setupWebhook(e){if(console.clear(),console.log(UIRenderer.renderTitle()),console.log("\nüîó C·∫•u h√¨nh Webhook Discord"),console.log("=".repeat(50)),this.webhookConfig){console.log("\nüìã C·∫•u h√¨nh hi·ªán t·∫°i:");const o=this.webhookConfig.url.split("/"),n=o[o.length-2]||"unknown";console.log(`üîó Webhook ID: ${n}`),console.log("üîó URL: [ƒê√É ·∫®N V√å L√ù DO B·∫¢O M·∫¨T]"),console.log(`‚è±Ô∏è Th·ªùi gian g·ª≠i: ${this.webhookConfig.intervalMinutes} ph√∫t`),console.log("üìä Tr·∫°ng th√°i: "+(this.webhookConfig.enabled?"‚úÖ ƒê√£ b·∫≠t":"‚ùå ƒê√£ t·∫Øt")),console.log("\nüéØ Ch·ªçn h√†nh ƒë·ªông:"),console.log("1. ‚úèÔ∏è Ch·ªânh s·ª≠a webhook"),console.log("2. üîÑ B·∫≠t/T·∫Øt webhook"),console.log("3. ‚ùå X√≥a webhook"),console.log("4. ‚è≠Ô∏è Quay l·∫°i menu ch√≠nh");const t=await Utils.ask(e,"\nNh·∫≠p l·ª±a ch·ªçn (1-4): ");if("1"===t.trim())await this.editWebhook(e);else if("2"===t.trim())await this.toggleWebhook(e);else{if("3"!==t.trim())return;await this.deleteWebhook(e)}}else{console.log("\nüìù Ch∆∞a c√≥ c·∫•u h√¨nh webhook!"),console.log("\nüéØ Ch·ªçn h√†nh ƒë·ªông:"),console.log("1. ‚ûï T·∫°o webhook m·ªõi"),console.log("2. ‚è≠Ô∏è Quay l·∫°i menu ch√≠nh");if("1"!==(await Utils.ask(e,"\nNh·∫≠p l·ª±a ch·ªçn (1-2): ")).trim())return;await this.createWebhook(e)}}async createWebhook(e){let o,n;for(console.log("\nüìù T·∫°o c·∫•u h√¨nh webhook m·ªõi:");o=await Utils.ask(e,"üîó Nh·∫≠p URL webhook Discord: "),!o.trim()||!o.includes("discord.com/api/webhooks/");)console.log("‚ùå URL webhook kh√¥ng h·ª£p l·ªá! Vui l√≤ng nh·∫≠p l·∫°i.");for(;;){const o=await Utils.ask(e,"‚è±Ô∏è Th·ªùi gian g·ª≠i webhook (5-180 ph√∫t): ");if(n=parseInt(o),n>=5&&n<=180)break;console.log("‚ùå Th·ªùi gian ph·∫£i t·ª´ 5-180 ph√∫t! Vui l√≤ng nh·∫≠p l·∫°i.")}this.webhookConfig={url:o.trim(),intervalMinutes:n,enabled:!0},Utils.saveWebhookConfig(this.webhookConfig),console.log("‚úÖ ƒê√£ l∆∞u c·∫•u h√¨nh webhook!"),await new Promise((e=>setTimeout(e,2e3)))}async editWebhook(e){let o,n;for(console.log("\n‚úèÔ∏è Ch·ªânh s·ª≠a webhook:");;){const n=this.webhookConfig.url.split("/"),t=n[n.length-2]||"unknown";if(o=await Utils.ask(e,`üîó Webhook ID hi·ªán t·∫°i: ${t}\nüîó URL: [ƒê√É ·∫®N V√å L√ù DO B·∫¢O M·∫¨T]\nNh·∫≠p URL m·ªõi (Enter ƒë·ªÉ gi·ªØ nguy√™n): `),!o.trim()){o=this.webhookConfig.url;break}if(o.includes("discord.com/api/webhooks/"))break;console.log("‚ùå URL webhook kh√¥ng h·ª£p l·ªá! Vui l√≤ng nh·∫≠p l·∫°i.")}for(;;){const o=await Utils.ask(e,`‚è±Ô∏è Th·ªùi gian hi·ªán t·∫°i: ${this.webhookConfig.intervalMinutes} ph√∫t\nNh·∫≠p th·ªùi gian m·ªõi (5-180 ph√∫t, Enter ƒë·ªÉ gi·ªØ nguy√™n): `);if(!o.trim()){n=this.webhookConfig.intervalMinutes;break}if(n=parseInt(o),n>=5&&n<=180)break;console.log("‚ùå Th·ªùi gian ph·∫£i t·ª´ 5-180 ph√∫t! Vui l√≤ng nh·∫≠p l·∫°i.")}this.webhookConfig={url:o.trim(),intervalMinutes:n,enabled:this.webhookConfig.enabled},Utils.saveWebhookConfig(this.webhookConfig),console.log("‚úÖ ƒê√£ c·∫≠p nh·∫≠t c·∫•u h√¨nh webhook!"),await new Promise((e=>setTimeout(e,2e3)))}async toggleWebhook(e){console.log("\nüîÑ B·∫≠t/T·∫Øt webhook:");const o=this.webhookConfig.url.split("/"),n=o[o.length-2]||"unknown";console.log(`üîó Webhook ID: ${n}`),console.log("üîó URL: [ƒê√É ·∫®N V√å L√ù DO B·∫¢O M·∫¨T]"),console.log(`‚è±Ô∏è Th·ªùi gian g·ª≠i: ${this.webhookConfig.intervalMinutes} ph√∫t`),console.log("üìä Tr·∫°ng th√°i hi·ªán t·∫°i: "+(this.webhookConfig.enabled?"‚úÖ ƒê√£ b·∫≠t":"‚ùå ƒê√£ t·∫Øt"));const t=!this.webhookConfig.enabled,s=t?"b·∫≠t":"t·∫Øt",a=await Utils.ask(e,`\n‚ö†Ô∏è B·∫°n c√≥ mu·ªën ${s} webhook? (y/N): `);"y"===a.toLowerCase()||"yes"===a.toLowerCase()?(this.webhookConfig.enabled=t,Utils.saveWebhookConfig(this.webhookConfig),console.log(`‚úÖ ƒê√£ ${s} webhook!`),t?console.log("üìä Webhook s·∫Ω g·ª≠i b√°o c√°o t·ª± ƒë·ªông."):console.log("üìä Webhook s·∫Ω kh√¥ng g·ª≠i b√°o c√°o t·ª± ƒë·ªông."),await new Promise((e=>setTimeout(e,3e3)))):(console.log("‚ùå ƒê√£ h·ªßy thay ƒë·ªïi tr·∫°ng th√°i webhook."),await new Promise((e=>setTimeout(e,2e3))))}async deleteWebhook(e){console.log("\n‚ùå X√≥a c·∫•u h√¨nh webhook:");const o=this.webhookConfig.url.split("/"),n=o[o.length-2]||"unknown";console.log(`üîó Webhook ID: ${n}`),console.log("üîó URL: [ƒê√É ·∫®N V√å L√ù DO B·∫¢O M·∫¨T]"),console.log(`‚è±Ô∏è Th·ªùi gian g·ª≠i: ${this.webhookConfig.intervalMinutes} ph√∫t`);const t=await Utils.ask(e,"\n‚ö†Ô∏è B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a webhook? (y/N): ");"y"===t.toLowerCase()||"yes"===t.toLowerCase()?(Utils.saveWebhookConfig(null),this.webhookConfig=null,console.log("‚úÖ ƒê√£ x√≥a c·∫•u h√¨nh webhook!"),console.log("üìä Webhook s·∫Ω kh√¥ng c√≤n g·ª≠i b√°o c√°o t·ª± ƒë·ªông."),await new Promise((e=>setTimeout(e,3e3)))):(console.log("‚ùå ƒê√£ h·ªßy x√≥a webhook."),await new Promise((e=>setTimeout(e,2e3))))}async sendStatusWebhook(e,o){if(this.webhookConfig&&this.webhookConfig.enabled)try{const n=UIRenderer.getSystemStats(),t=Date.now()-o,s=Math.floor(t/36e5),a=Math.floor(t%36e5/6e4),i=Math.floor(t%6e4/1e3),c=e.filter((e=>"Online ‚úÖ"===e.status||e.status.includes("Online"))).length,l=e.map((e=>{let o;return o="com.roblox.client"===e.packageName?"Global üåç":"com.roblox.client.vnggames"===e.packageName?"VNG üáªüá≥":e.packageName,`${o}: ${e.status}`})).join("\n"),r={title:"üñ•Ô∏è Dawn Rejoin Status Report",color:65280,timestamp:(new Date).toISOString(),fields:[{name:"üíª CPU Usage",value:`${n.cpuUsage}%`,inline:!0},{name:"üß† RAM Usage",value:n.ramUsage,inline:!0},{name:"‚è±Ô∏è Uptime",value:`${s}h ${a}m ${i}s`,inline:!0},{name:"üöÄ Active Instances",value:`${c}/${e.length}`,inline:!0},{name:"üì¶ Package Status",value:l.length>1024?l.substring(0,1021)+"...":l,inline:!1}],footer:{text:"Dawn Rejoin Tool - The Real Dawn"}},h=await Utils.takeScreenshot();await Utils.sendWebhookEmbed(this.webhookConfig.url,r,h)}catch(e){console.error(`‚ùå L·ªói khi g·ª≠i webhook: ${e.message}`)}}}class ConfigEditor{constructor(){this.configs=Utils.loadMultiConfigs()}async startEdit(e){try{if(0===Object.keys(this.configs).length)return console.log("‚ùå Ch∆∞a c√≥ config n√†o! Vui l√≤ng ch·∫°y setup packages tr∆∞·ªõc."),await new Promise((e=>setTimeout(e,2e3))),!1;console.log("\nüìã Danh s√°ch config hi·ªán t·∫°i:"),console.log(this.renderConfigTable()),console.log("\nüéØ Ch·ªçn config ƒë·ªÉ ch·ªânh s·ª≠a:"),console.log("0. ‚úèÔ∏è S·ª≠a t·∫•t c·∫£ config");let o=1;const n=[];for(const[e,t]of Object.entries(this.configs))try{let s;s="com.roblox.client"===e?"Global üåç":"com.roblox.client.vnggames"===e?"VNG üáªüá≥":e;const a=Utils.maskSensitiveInfo(t.username);Utils.maskSensitiveInfo(t.userId);console.log(`${o}. ${s} (${a}) - Game: ${t.gameName||"Unknown"}`),n.push({packageName:e,config:t}),o++}catch(o){console.log(`‚ö†Ô∏è L·ªói khi x·ª≠ l√Ω config ${e}: ${o.message}`);continue}if(0===n.length)return console.log("‚ùå Kh√¥ng c√≥ config h·ª£p l·ªá n√†o!"),await new Promise((e=>setTimeout(e,2e3))),!1;const t=await Utils.ask(e,"\nNh·∫≠p l·ª±a ch·ªçn (0 ƒë·ªÉ s·ª≠a t·∫•t c·∫£, ho·∫∑c s·ªë c√°ch nhau b·ªüi kho·∫£ng tr·∫Øng): ");let s=[];if("0"===t.trim())s=n,console.log("‚úèÔ∏è S·∫Ω s·ª≠a t·∫•t c·∫£ config!");else try{const o=t.trim().split(/\s+/).map((e=>parseInt(e)-1)).filter((e=>e>=0&&e<n.length));if(0===o.length)return console.log("‚ùå L·ª±a ch·ªçn kh√¥ng h·ª£p l·ªá!"),await new Promise((e=>setTimeout(e,1e3))),await this.startEdit(e);s=o.map((e=>n[e])),console.log("‚úèÔ∏è S·∫Ω s·ª≠a c√°c config:"),s.forEach(((e,o)=>{try{const n=Utils.maskSensitiveInfo(e.config.username);console.log(`  - ${o+1}. ${e.packageName} (${n})`)}catch(n){console.log(`  - ${o+1}. ${e.packageName} (L·ªói hi·ªÉn th·ªã)`)}}))}catch(o){return console.log(`‚ùå L·ªói khi x·ª≠ l√Ω l·ª±a ch·ªçn: ${o.message}`),await new Promise((e=>setTimeout(e,1e3))),await this.startEdit(e)}for(const{packageName:o,config:n}of s)try{let t;console.clear(),console.log(UIRenderer.renderTitle()),console.log(`\n‚úèÔ∏è Ch·ªânh s·ª≠a config cho ${o}`),t="com.roblox.client"===o?"Global üåç":"com.roblox.client.vnggames"===o?"VNG üáªüá≥":o,console.log(`üì¶ Package: ${t}`),console.log(`üë§ Username: ${Utils.maskSensitiveInfo(n.username)}`),console.log(`üÜî User ID: ${Utils.maskSensitiveInfo(n.userId)}`),console.log(`üéÆ Game: ${n.gameName||"Unknown"} (${n.placeId||"Unknown"})`),console.log(`‚è±Ô∏è Delay: ${n.delaySec||"Unknown"}s`),n.linkCode&&console.log(`üîó Link Code: ${n.linkCode}`),console.log("\nüìù Ch·ªçn th√¥ng tin ƒë·ªÉ ch·ªânh s·ª≠a:"),console.log("1. üéÆ Thay ƒë·ªïi game"),console.log("2. ‚è±Ô∏è Thay ƒë·ªïi delay"),console.log("3. üîó Thay ƒë·ªïi link code"),console.log("4. ‚ùå X√≥a config n√†y"),console.log("5. ‚è≠Ô∏è B·ªè qua (gi·ªØ nguy√™n)");const s=await Utils.ask(e,"\nCh·ªçn option (1-5): ");try{switch(s.trim()){case"1":const s=new GameSelector,a=await s.chooseGame(e);n.placeId=a.placeId,n.gameName=a.name,n.linkCode=a.linkCode,console.log(`‚úÖ ƒê√£ c·∫≠p nh·∫≠t game th√†nh ${a.name}!`);break;case"2":let i;for(;;)try{const o=await Utils.ask(e,"‚è±Ô∏è Delay check m·ªõi (gi√¢y, 15-120): "),n=parseInt(o)||0;if(n>=15&&n<=120){i=n;break}console.log("‚ùå Gi√° tr·ªã kh√¥ng h·ª£p l·ªá! Vui l√≤ng nh·∫≠p l·∫°i.")}catch(e){console.log("‚ùå L·ªói khi nh·∫≠p delay, vui l√≤ng th·ª≠ l·∫°i.")}n.delaySec=i,console.log(`‚úÖ ƒê√£ c·∫≠p nh·∫≠t delay th√†nh ${i}s!`);break;case"3":for(console.log("\nüìé D√°n link redirect sau khi v√†o private server."),console.log("VD: https://www.roblox.com/games/2753915549/Blox-Fruits?privateServerLinkCode=77455530946706396026289495938493");;)try{const o=(await Utils.ask(e,"\nD√°n link redirect ƒë√£ chuy·ªÉn h∆∞·ªõng: ")).match(/\/games\/(\d+)[^?]*\?[^=]*=([\w-]+)/);if(!o){console.log("‚ùå Link kh√¥ng h·ª£p l·ªá!");continue}n.placeId=o[1],n.gameName="Private Server üîí",n.linkCode=o[2],console.log("‚úÖ ƒê√£ c·∫≠p nh·∫≠t link code!");break}catch(e){console.log(`‚ùå L·ªói khi x·ª≠ l√Ω link: ${e.message}`)}break;case"4":delete this.configs[o],console.log(`‚úÖ ƒê√£ x√≥a config cho ${t}!`);break;case"5":console.log(`‚è≠Ô∏è Gi·ªØ nguy√™n config cho ${t}`);break;default:console.log("‚ùå L·ª±a ch·ªçn kh√¥ng h·ª£p l·ªá!")}}catch(e){console.log(`‚ùå L·ªói khi ch·ªânh s·ª≠a config: ${e.message}`)}}catch(e){console.log(`‚ùå L·ªói khi x·ª≠ l√Ω config ${o}: ${e.message}`);continue}try{Utils.saveMultiConfigs(this.configs),console.log("\n‚úÖ Ho√†n t·∫•t ch·ªânh s·ª≠a config!")}catch(e){console.log(`‚ùå L·ªói khi l∆∞u config: ${e.message}`)}return!0}catch(e){return console.log(`‚ùå L·ªói nghi√™m tr·ªçng trong ConfigEditor: ${e.message}`),await new Promise((e=>setTimeout(e,2e3))),!1}}renderConfigTable(){try{const e=new Table({head:["STT","Package","Username","Delay","Game ID","Game Name","Server VIP Link"],colWidths:[5,20,15,8,15,20,15],style:{head:["cyan"],border:["gray"]}});let o=1;for(const[n,t]of Object.entries(this.configs))try{let s;s="com.roblox.client"===n?"Global üåç":"com.roblox.client.vnggames"===n?"VNG üáªüá≥":n;const a=Utils.maskSensitiveInfo(t.username),i=`${t.delaySec||"Unknown"}s`,c=t.linkCode?"C√≥ üîó":"Kh√¥ng ‚ùå";e.push([o.toString(),s,a,i,t.placeId||"Unknown",t.gameName||"Unknown",c]),o++}catch(t){console.log(`‚ö†Ô∏è L·ªói khi x·ª≠ l√Ω config ${n}: ${t.message}`),e.push([o.toString(),n,"Error","Error","Error","Error","Error"]),o++}return e.toString()}catch(e){return console.log(`‚ùå L·ªói khi t·∫°o b·∫£ng config: ${e.message}`),"‚ùå Kh√¥ng th·ªÉ hi·ªÉn th·ªã b·∫£ng config"}}}process.on("SIGINT",(()=>{console.log("\n\nüõë ƒêang d·ª´ng ch∆∞∆°ng tr√¨nh..."),console.log("üëã C·∫£m ∆°n b·∫°n ƒë√£ s·ª≠ d·ª•ng Dawn Rejoin Tool!"),process.exit(0)})),(async()=>{const e=new MultiRejoinTool;await e.start()})();
